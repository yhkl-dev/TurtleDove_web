webpackJsonp([16],{Ypc9:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("aA9S"),i=o.n(a),l=o("o3g8"),s={data:function(){return{name:"",userList:[],total_num:0,page:1,listLoading:!0,loading:!0,search_user_key:"",userGroupList:[],addUserForm:{username:"",name:"",password:"",phone:""},addUserRule:{username:[{required:!0,message:"请输入登陆名",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],password:[{required:!0,trigger:"blur",validator:function(e,t,o){t.length<5?o(new Error("密码不能小于5位")):o()}}],phone:[{required:!1,validator:function(e,t,o){t&&11!==t.length?o(new Error("请确保这个字段至少包含 11 个字符")):o()},trigger:"blur"}]},rolesList:[],addUserFormVisible:!1,chooseRoleVisible:!1,chooseRole:{},roles:[],changeMobileFormVisible:!1,changeMobileForm:{},checkRoleVisible:!1,roleTags:[]}},created:function(){var e=this;this.fetchData(),Object(l.j)({page_size:0}).then(function(t){e.rolesList=t})},methods:{fetchData:function(){var e=this;this.loading=!0,Object(l.l)({page:this.page,username:this.search_user_key}).then(function(t){e.userList=t.results,e.total_num=t.count,e.loading=!1})},searchClick:function(){this.page=1,this.fetchData()},paginationChange:function(e){this.page=e,this.fetchData()},deleteClick:function(e){var t=this;this.$confirm("此操作将删除用户 “"+e.name+"” , 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.f)(e.id).then(function(o){t.$message({message:"删除用户 “"+e.name+"” 成功",type:"success"}),t.fetchData()})}).catch(function(){t.$message({message:"操作失败",type:"error"})})},addClick:function(){this.addUserFormVisible=!0,void 0!==this.$refs.addUserForm&&this.$refs.addUserForm.resetFields()},submitAddClick:function(){var e=this;this.$refs.addUserForm.validate(function(t){if(t){var o=i()({},e.addUserForm);Object(l.b)(o).then(function(t){e.addUserFormVisible=!1,e.fetchData(),e.$message({message:"操作成功",type:"success"})})}})},statusChange:function(e){var t=this;Object(l.o)(e.id,{is_active:e.is_active}).then(function(){t.fetchData(),t.$message({message:"操作成功",type:"success"})})},chooceRoleClick:function(e){var t=this;this.roles=[],this.chooseRoleVisible=!0,this.chooseRole=i()({},e),Object(l.k)(e.id,{page_size:0}).then(function(e){t.roles=e.map(function(e){return e.id})})},submitChooseRoleClick:function(){var e=this;this.roles.length?Object(l.p)(this.chooseRole.id,{gid:this.roles}).then(function(t){e.chooseRoleVisible=!1,e.$message({message:"操作成功",type:"success"})}):this.$message.error("请选择角色")},changeMobileClick:function(e){this.changeMobileFormVisible=!0,this.changeMobileForm=e},submitChangeMobileClick:function(){var e=this;this.$refs.changeMobileForm.validate(function(t){t&&Object(l.o)(e.changeMobileForm.id,{phone:e.changeMobileForm.phone}).then(function(){e.changeMobileFormVisible=!1,e.fetchData(),e.$message({message:"操作成功",type:"success"})})})},checkRoleClick:function(e){var t=this;this.roleTags=[],Object(l.k)(e.id,{page_size:0}).then(function(e){t.roleTags=e,t.roleTags.length>0&&(t.checkRoleVisible=!0)})}}},n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("div",{staticClass:"filter-container"},[o("el-input",{staticStyle:{width:"30%"},attrs:{size:"small",placeholder:"搜索"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchClick(t)}},model:{value:e.search_user_key,callback:function(t){e.search_user_key=t},expression:"search_user_key"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchClick},slot:"append"})],1),e._v(" "),o("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addClick}},[e._v("添加用户")])],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{"element-loading-text":"拼命加载中",data:e.userList}},[o("el-table-column",{attrs:{prop:"username",label:"用户名",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"姓名",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"phone",label:"手机号",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"email",label:"Email",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"is_active",label:"登录状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(o){return e.statusChange(t.row)}},model:{value:t.row.is_active,callback:function(o){e.$set(t.row,"is_active",o)},expression:"scope.row.is_active"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"last_login",label:"上次登陆时间",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"",label:"操作",width:"400",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){return e.checkRoleClick(t.row)}}},[e._v("查看角色")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){return e.chooceRoleClick(t.row)}}},[e._v("指定角色")]),e._v(" "),o("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(o){return e.changeMobileClick(t.row)}}},[e._v("修改")]),e._v(" "),o("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(o){return e.deleteClick(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.total_num>=10,expression:"total_num>=10"}],staticClass:"text-center"},[o("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":e.page,total:e.total_num},on:{"current-change":e.paginationChange,"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t}}})],1),e._v(" "),o("el-dialog",{attrs:{title:"增加用户",visible:e.addUserFormVisible,width:"500px"},on:{"update:visible":function(t){e.addUserFormVisible=t}}},[o("el-form",{ref:"addUserForm",attrs:{model:e.addUserForm,"label-width":"70px",rules:e.addUserRule}},[o("el-form-item",{attrs:{label:"登陆名",prop:"username"}},[o("el-input",{attrs:{placeholder:"请输入登陆名"},model:{value:e.addUserForm.username,callback:function(t){e.$set(e.addUserForm,"username",t)},expression:"addUserForm.username"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"姓名",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.addUserForm.name,callback:function(t){e.$set(e.addUserForm,"name",t)},expression:"addUserForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"密码",prop:"password"}},[o("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.addUserForm.password,callback:function(t){e.$set(e.addUserForm,"password",t)},expression:"addUserForm.password"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[o("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.addUserForm.phone,callback:function(t){e.$set(e.addUserForm,"phone",t)},expression:"addUserForm.phone"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small"},on:{click:function(t){e.addUserFormVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitAddClick}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"查看角色",visible:e.checkRoleVisible},on:{"update:visible":function(t){e.checkRoleVisible=t}}},[o("div",{staticClass:"text-center"},e._l(e.roleTags,function(t,a){return o("el-tag",{key:a,staticStyle:{margin:"0 10px"},attrs:{type:"info"}},[e._v(e._s(t.name))])}),1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.checkRoleVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.checkRoleVisible=!1}}},[e._v("确 定")])],1)]),e._v(" "),o("el-dialog",{attrs:{title:"指定角色",visible:e.chooseRoleVisible},on:{"update:visible":function(t){e.chooseRoleVisible=t}}},[o("el-form",{attrs:{model:e.chooseRole,"label-width":"70px"}},[o("el-form-item",{attrs:{label:"用户名"}},[o("el-input",{attrs:{disabled:""},model:{value:e.chooseRole.username,callback:function(t){e.$set(e.chooseRole,"username",t)},expression:"chooseRole.username"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"角色"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择角色"},model:{value:e.roles,callback:function(t){e.roles=t},expression:"roles"}},e._l(e.rolesList,function(e,t){return o("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.chooseRoleVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.submitChooseRoleClick}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"修改手机号",visible:e.changeMobileFormVisible},on:{"update:visible":function(t){e.changeMobileFormVisible=t}}},[o("el-form",{ref:"changeMobileForm",attrs:{model:e.changeMobileForm,"label-width":"70px",rules:e.addUserRule}},[o("el-form-item",{attrs:{label:"登陆名"}},[o("el-input",{attrs:{placeholder:"请输入登陆名",disabled:""},model:{value:e.changeMobileForm.username,callback:function(t){e.$set(e.changeMobileForm,"username",t)},expression:"changeMobileForm.username"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[o("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.changeMobileForm.phone,callback:function(t){e.$set(e.changeMobileForm,"phone",t)},expression:"changeMobileForm.phone"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.changeMobileFormVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.submitChangeMobileClick}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var r=o("/Xao")(s,n,!1,function(e){o("zTFZ")},"data-v-1e104cb2",null);t.default=r.exports},adqz:function(e,t,o){(e.exports=o("UTlt")(!1)).push([e.i,'\n.text[data-v-1e104cb2] {\n  font-size: 14px;\n}\n.item[data-v-1e104cb2] {\n  margin-bottom: 18px;\n}\n.clearfix[data-v-1e104cb2]:before,\n.clearfix[data-v-1e104cb2]:after {\n  display: table;\n  content: "";\n}\n.clearfix[data-v-1e104cb2]:after {\n  clear: both\n}\n.box-card[data-v-1e104cb2] {\n  width: 480px;\n}\n',""])},zTFZ:function(e,t,o){var a=o("adqz");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);o("8bSs")("60e5adda",a,!0)}});