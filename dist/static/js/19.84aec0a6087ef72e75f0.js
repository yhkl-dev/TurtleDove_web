webpackJsonp([19],{tfTw:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("o3g8"),n={data:function(){return{groupList:[],total_num:0,page:1,loading:!1,search_role:"",checkPermissionVisible:!1,permissionloading:!1,permissionList:[],addRoleVisible:!1,addRoleForm:{name:""},addRoleRule:{name:[{required:!0,message:"请输入角色名",trigger:"blur"}]},groupMemberListVisible:!1,groupMemberListData:[],groupMemberPage:1,groupMemberLoading:!1,groupMemberGID:0,groupMemberSearchKey:"",groupMemberTotal:0,modifyGroupPermissionVisible:!1,modifyGroupPermissionSearchKey:"",modifyGroupPermissionPage:1,modifyGroupPermissionLoading:!1,modifyGroupPermissionGID:0,modifyGroupPermissionData:[],modifyGroupPermissionTotal:0,menuFlag:!1,groupMenuVisible:!1,menuData:[],defaultCheckedKeys:[],menuModifyData:{gid:0,mid:[]}}},created:function(){this.fetchGroupData()},methods:{fetchGroupData:function(){var e=this;this.loading=!0,Object(o.j)({page:this.page,name:this.search_role}).then(function(t){e.groupList=t.results,e.total_num=t.count,e.loading=!1})},searchClick:function(){this.page=1,this.fetchGroupData()},paginationChange:function(e){this.page=e,this.fetchGroupData()},checkPermissionClick:function(e){var t=this;this.checkPermissionVisible=!0,this.permissionloading=!0,this.permissionList=[],Object(o.i)(e,{page_size:0}).then(function(e){t.permissionList=e,t.permissionloading=!1})},changePermissionClick:function(e){this.modifyGroupPermissionGID=e.id,this.modifyGroupPermissionVisible=!0,this.modifyGroupPermissionData=[],this.modifyGroupPermissionTotal=0,this.fetchModifyGroupPermissionData()},addRoleClick:function(){this.addRoleVisible=!0,void 0!==this.$refs.addRoleForm&&this.$refs.addRoleForm.resetFields()},submitAddRoleClick:function(){var e=this;this.$refs.addRoleForm.validate(function(t){t&&Object(o.a)({name:e.addRoleForm.name}).then(function(t){e.addRoleVisible=!1,e.fetchGroupData()})})},deleteGroupClick:function(e){var t=this;this.$confirm("此操作将删除用户 “"+e.name+"” , 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.c)(e.id).then(function(i){t.$message({message:"删除用户 “"+e.name+"” 成功",type:"success"}),t.fetchGroupData()})}).catch(function(){})},groupMemberClick:function(e){this.groupMemberGID=e,this.groupMemberListVisible=!0,this.fetchGroupMemberList()},renderContent:function(e,t){var i=t.node,o=t.data;t.store;return e("span",{style:"flex: 1; display: flex; align-items: center; justify-content: space-between; font-size: 14px; padding-right: 8px;"},[e("span",null,[e("span",null,[i.label])]),e("span",null,[o.show?"显示":"隐藏"])])},showGroupMenus:function(e){var t=this;this.menuData=[],this.menuFlag=!1,this.groupMenuVisible=!0,Object(o.h)(e).then(function(e){t.menuData=e})},changeGroupMenus:function(e){var t=this;this.menuData=[],this.menuFlag=!0,this.groupMenuVisible=!0,this.menuModifyData.gid=e,this.defaultCheckedKeys=[],Object(o.h)(e,{modify:!0}).then(function(e){t.menuData=e.data,t.defaultCheckedKeys=e.permissions})},submitGroupMenus:function(){var e=this;this.menuFlag?(console.log(this.$refs.tree.getCheckedKeys()),Object(o.m)(this.menuModifyData.gid,{mid:this.$refs.tree.getCheckedKeys()}).then(function(t){e.groupMenuVisible=!1,e.$message({message:"操作成功",type:"success"})})):this.groupMenuVisible=!1},fetchGroupMemberList:function(){var e=this;this.groupMemberLoading=!0,Object(o.g)(this.groupMemberGID,{page:this.groupMemberPage,username:this.groupMemberSearchKey}).then(function(t){e.groupMemberListData=t.results,e.groupMemberTotal=t.count,e.groupMemberLoading=!1})},groupMemberSearchClick:function(){this.groupMemberPage=1,this.fetchGroupMemberList()},groupMemberPaginationChange:function(e){this.groupMemberPage=e,this.fetchGroupMemberList()},groupMemberDeleteClick:function(e){var t=this;this.$confirm("此操作将删除组成员 “"+e.name+"” , 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.d)(t.groupMemberGID,{uid:e.id}).then(function(i){t.$message({message:"删除组成员 “"+e.name+"” 成功",type:"success"}),t.fetchGroupMemberList(),t.fetchGroupData()})}).catch(function(){})},fetchModifyGroupPermissionData:function(){var e=this;this.modifyGroupPermissionLoading=!0,Object(o.i)(this.modifyGroupPermissionGID,{page:this.modifyGroupPermissionPage,page_size:6,name:this.modifyGroupPermissionSearchKey,modify:!0}).then(function(t){e.modifyGroupPermissionData=t.results,e.modifyGroupPermissionTotal=t.count,e.modifyGroupPermissionLoading=!1})},modifyGroupPermissionSearchClick:function(){this.modifyGroupPermissionPage=1,this.fetchModifyGroupPermissionData()},modifyGroupPermissionChangeStatus:function(e){var t=this;e.status=!e.status,e.status?Object(o.e)(this.modifyGroupPermissionGID,{pid:e.id}).then(function(i){e.status=!e.status,t.$message.success("删除权限成功！")}):Object(o.n)(this.modifyGroupPermissionGID,{pid:e.id}).then(function(i){e.status=!e.status,t.$message.success("添加权限成功！")})},modifyGroupPermissionPaginationChange:function(e){this.modifyGroupPermissionPage=e,this.fetchModifyGroupPermissionData()}}},a={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-input",{staticStyle:{width:"30%"},attrs:{size:"small",placeholder:"搜索"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchClick(t)}},model:{value:e.search_role,callback:function(t){e.search_role=t},expression:"search_role"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchClick},slot:"append"})],1),e._v(" "),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addRoleClick}},[e._v("添加角色")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{"element-loading-text":"拼命加载中",data:e.groupList}},[i("el-table-column",{attrs:{prop:"name",label:"角色名",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{label:"成员管理",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(i){return i.preventDefault(),e.groupMemberClick(t.row.id)}}},[e._v("\n                  "+e._s("成员列表（"+t.row.member+"）人")+"\n              ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"",label:"api接口权限",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.checkPermissionClick(t.row.id)}}},[e._v("查看")]),e._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.changePermissionClick(t.row)}}},[e._v("修改")])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"",label:"前端权限",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.showGroupMenus(t.row.id)}}},[e._v("查看")]),e._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.changeGroupMenus(t.row.id)}}},[e._v("修改")])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.deleteGroupClick(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.total_num>=10,expression:"total_num>=10"}],staticClass:"text-center"},[i("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":e.page,total:e.total_num},on:{"current-change":e.paginationChange,"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t}}})],1),e._v(" "),i("el-dialog",{attrs:{title:"添加角色",visible:e.addRoleVisible,width:"500px"},on:{"update:visible":function(t){e.addRoleVisible=t}}},[i("el-form",{ref:"addRoleForm",attrs:{model:e.addRoleForm,"label-width":"70px",rules:e.addRoleRule}},[i("el-form-item",{attrs:{label:"角色名",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入角色名"},model:{value:e.addRoleForm.name,callback:function(t){e.$set(e.addRoleForm,"name",t)},expression:"addRoleForm.name"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.addRoleVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.submitAddRoleClick}},[e._v("确 定")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"成员列表",visible:e.groupMemberListVisible},on:{"update:visible":function(t){e.groupMemberListVisible=t}}},[i("el-row",{attrs:{gutter:24}},[i("el-col",{attrs:{span:12}},[i("el-input",{attrs:{placeholder:"搜索"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.groupMemberSearchClick(t)}},model:{value:e.groupMemberSearchKey,callback:function(t){e.groupMemberSearchKey=t},expression:"groupMemberSearchKey"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.groupMemberSearchClick},slot:"append"})],1)],1)],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.groupMemberLoading,expression:"groupMemberLoading"}],staticClass:"table",attrs:{"element-loading-text":"拼命加载中",data:e.groupMemberListData,border:""}},[i("el-table-column",{attrs:{prop:"username",label:"用户名",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:"姓名",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"email",label:"邮件",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"ncfgroupuser.title",label:"上次登陆时间",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.groupMemberDeleteClick(t.row)}}},[e._v("删除\n          ")])]}}])})],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.groupMemberTotal>=10,expression:"groupMemberTotal>=10"}],staticClass:"text-center"},[i("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":e.groupMemberPage,total:e.groupMemberTotal},on:{"current-change":e.groupMemberPaginationChange,"update:currentPage":function(t){e.groupMemberPage=t},"update:current-page":function(t){e.groupMemberPage=t}}})],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"查看权限",visible:e.checkPermissionVisible},on:{"update:visible":function(t){e.checkPermissionVisible=t}}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.permissionloading,expression:"permissionloading"}],attrs:{"element-loading-text":"拼命加载中",data:e.permissionList,border:"",height:"300"}},[i("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{label:"权限名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.content_type.app_label+"."+t.row.codename)+"\n        ")]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:"描述",align:"center"}})],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"修改权限",visible:e.modifyGroupPermissionVisible,width:"1000px"},on:{"update:visible":function(t){e.modifyGroupPermissionVisible=t}}},[i("el-row",{attrs:{gutter:24}},[i("el-col",{attrs:{span:12}},[i("el-input",{attrs:{placeholder:"搜索"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.modifyGroupPermissionSearchClick(t)}},model:{value:e.modifyGroupPermissionSearchKey,callback:function(t){e.modifyGroupPermissionSearchKey=t},expression:"modifyGroupPermissionSearchKey"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.modifyGroupPermissionSearchClick},slot:"append"})],1)],1)],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.modifyGroupPermissionLoading,expression:"modifyGroupPermissionLoading"}],staticClass:"table",attrs:{"element-loading-text":"拼命加载中",data:e.modifyGroupPermissionData,border:""}},[i("el-table-column",{attrs:{prop:"content_type.app_label",label:"app",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"content_type.model",label:"model",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"codename",label:"code name",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:"描述",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-switch",{on:{change:function(i){return e.modifyGroupPermissionChangeStatus(t.row)}},model:{value:t.row.status,callback:function(i){e.$set(t.row,"status",i)},expression:"scope.row.status"}})]}}])})],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.modifyGroupPermissionTotal>=10,expression:"modifyGroupPermissionTotal>=10"}],staticClass:"text-center"},[i("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","page-size":"6","current-page":e.modifyGroupPermissionPage,total:e.modifyGroupPermissionTotal},on:{"current-change":e.modifyGroupPermissionPaginationChange,"update:currentPage":function(t){e.modifyGroupPermissionPage=t},"update:current-page":function(t){e.modifyGroupPermissionPage=t}}})],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"查看前端菜单",visible:e.groupMenuVisible,width:"400px"},on:{"update:visible":function(t){e.groupMenuVisible=t}}},[i("el-tree",{ref:"tree",attrs:{data:e.menuData,"show-checkbox":e.menuFlag,"default-expand-all":"","node-key":"id","highlight-current":"","default-checked-keys":e.defaultCheckedKeys,"render-content":e.renderContent}}),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.groupMenuVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.submitGroupMenus}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]},r=i("/Xao")(n,a,!1,null,null,null);t.default=r.exports}});