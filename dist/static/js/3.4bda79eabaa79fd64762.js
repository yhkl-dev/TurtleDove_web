webpackJsonp([3],{"+k1o":function(e,r,t){(e.exports=t("UTlt")(!1)).push([e.i,"\n.el-row[data-v-068ecdf6] {\n  margin-bottom: 10px;\n}\n",""])},"1/UJ":function(e,r,t){var o=t("JxPy");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t("8bSs")("36c2339a",o,!0)},AUUv:function(e,r,t){var o=t("p7OI");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t("8bSs")("34b290a7",o,!0)},AvdV:function(e,r,t){(e.exports=t("UTlt")(!1)).push([e.i,"\n.div_class[data-v-103bde3e] {\n  margin-left: 20px;\n  position: relative;\n}\n",""])},B9f7:function(e,r,t){var o=t("fQsc");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t("8bSs")("43599746",o,!0)},EMlb:function(e,r,t){"use strict";r.d=function(e){return Object(o.a)({url:"/projectList/",method:"get",params:e})},r.b=function(e){return Object(o.a)({url:"/projectList/",method:"post",data:e})},r.f=function(e,r){return Object(o.a)({url:"/projectList/"+e+"/",method:"put",data:r})},r.a=function(e){return Object(o.a)({url:"/projectConfigure/",method:"post",data:e})},r.e=function(e,r){return Object(o.a)({url:"/projectConfigure/"+e+"/",method:"put",data:r})},r.c=function(e){return Object(o.a)({url:"/projectConfigure/"+e+"/",method:"delete"})};var o=t("vLgD")},JxPy:function(e,r,t){(e.exports=t("UTlt")(!1)).push([e.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/*.work_order_class {*/\n/*  overflow: scroll;*/\n/*}*/\n.el-select .el-input[data-v-47b2a0a5] {\n  width: 130px;\n}\n.input-with-select .el-input-group__prepend[data-v-47b2a0a5] {\n  background-color: #fff;\n}\n.el-tabs[data-v-47b2a0a5] {\n  margin-bottom: 10px;\n}\n",""])},QKGL:function(e,r,t){var o=t("+k1o");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t("8bSs")("259cd9df",o,!0)},VJN1:function(e,r,t){var o=t("lBSb");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t("8bSs")("63a8e4c2",o,!0)},cyZq:function(e,r,t){var o=t("zbLI");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t("8bSs")("5958a216",o,!0)},fQsc:function(e,r,t){(e.exports=t("UTlt")(!1)).push([e.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},lBSb:function(e,r,t){(e.exports=t("UTlt")(!1)).push([e.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},mPKF:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=t("J7No"),n=t("xJrl"),a=t("EMlb"),s=t("hRKE"),i=t.n(s),l={name:"workOrderDetail",props:["workOrderDetail"],data:function(){return{activeNames:["1","2","3","4","8"],replyContent:"",replyWorkOrderTaskForm:{ops_status:15,ops_reply_content:"",work_order:""},workOrderOperationForm:{ops_status:"",work_order:""}}},methods:{handleChange:function(e){console.log(e)},getElementIndex:function(e,r){if(null!==r){for(var t=[],o=0;o<e.length;o++)t.push(e[o].exec_user);return t.indexOf(r.exec_user)+1}},downloadAttachment:function(e){window.location.href=e},handleReplyWorkOrder:function(e){this.replyWorkOrderTaskForm.ops_reply_content=this.replyContent,this.replyWorkOrderTaskForm.work_order=e,this.$emit("replyWorkOrderTaskForm",this.replyWorkOrderTaskForm),this.replyContent=""},handleReEditWorkOrderOperation:function(e){this.workOrderOperationForm.ops_status=13,this.workOrderOperationForm.work_order=e,this.$emit("handleWorkOrderOperation",this.workOrderOperationForm)},handleCancelWorkOrderOperation:function(e){this.workOrderOperationForm.ops_status=14,this.workOrderOperationForm.work_order=e,this.$emit("handleWorkOrderOperation",this.workOrderOperationForm)},handleConfirmWorkOrderOperation:function(e){this.workOrderOperationForm.ops_status=11,this.workOrderOperationForm.work_order=e,this.$emit("handleWorkOrderOperation",this.workOrderOperationForm)}}},d={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"components-container"},[t("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(r){e.activeNames=r},expression:"activeNames"}},[t("el-collapse-item",{attrs:{title:"基础信息",name:"1"}},[t("el-row",[t("el-col",{attrs:{span:2}},[t("table",[t("tr",[t("td",[e._v("工单标题")])]),e._v(" "),t("tr",[t("td",[e._v("工单状态")])]),e._v(" "),t("tr",[t("td",[e._v("项目名称")])]),e._v(" "),t("tr",[t("td",[e._v("当前审核人")])]),e._v(" "),t("tr",[t("td",[e._v("当前执行人")])]),e._v(" "),t("tr",[t("td",[e._v("附件")])])])]),e._v(" "),t("el-col",{attrs:{span:6}},[t("table",[t("tr",[t("td",[e._v(e._s(e.workOrderDetail.order_title))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.status_name))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.order_project_name))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.current_audit_user||"暂无"))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.current_exec_user||"暂无"))])]),e._v(" "),t("tr",[t("td",[null!==e.workOrderDetail.download_url?t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){return e.downloadAttachment(e.workOrderDetail.download_url)}}},[e._v("\n                下载\n              ")]):e._e()],1)])])]),e._v(" "),t("el-col",{attrs:{span:2}},[t("table",[t("tr",[t("td",[e._v("工单ID")])]),e._v(" "),t("tr",[t("td",[e._v("产品线")])]),e._v(" "),t("tr",[t("td",[e._v("平台")])]),e._v(" "),t("tr",[t("td",[e._v("创建时间")])]),e._v(" "),t("tr",[t("td",[e._v("更新时间")])])])]),e._v(" "),t("el-col",{attrs:{span:8}},[t("table",[t("tr",[t("td",[e._v(e._s(e.workOrderDetail.order_task_id))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.order_product_name))])]),e._v(" "),t("tr",[t("td",e._l(e.workOrderDetail.order_env_type,function(r){return t("span",[t("el-tag",{attrs:{size:"mini",type:"success"}},[e._v(e._s(r.name))]),e._v(" "),t("span")],1)}),0)]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.create_time))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.update_time))])])])])],1)],1),e._v(" "),t("el-collapse-item",{attrs:{title:"工单需求",name:"2"}},[t("div",[e._v(e._s(e.workOrderDetail.order_purpose))])]),e._v(" "),t("el-collapse-item",{attrs:{title:"工单结果",name:"3"}},[t("div",[e._v(e._s(e.workOrderDetail.order_result))])]),e._v(" "),t("el-collapse-item",{attrs:{title:"审核信息",name:"4"}},[t("el-steps",{attrs:{"finish-status":"success","process-status":"wait",space:200,active:e.getElementIndex(e.workOrderDetail.audit_flow,e.workOrderDetail.current_audit_flow)}},e._l(e.workOrderDetail.audit_flow,function(e,r){return t("el-step",{key:r,attrs:{icon:"el-icon-user-solid",title:e.exec_user,description:e.status_name}})}),1)],1),e._v(" "),t("el-collapse-item",{attrs:{title:"执行信息",name:"5"}},[t("el-steps",{attrs:{"finish-status":"success","process-status":"wait",space:200,active:e.getElementIndex(e.workOrderDetail.exec_flow,e.workOrderDetail.current_exec_flow)}},e._l(e.workOrderDetail.exec_flow,function(e,r){return t("el-step",{key:r,attrs:{icon:"el-icon-user-solid",title:e.exec_user,description:e.status_name}})}),1)],1),e._v(" "),t("el-collapse-item",{attrs:{title:"操作记录",name:"6"}},e._l(e.workOrderDetail.operation_records,function(r,o){return t("div",{key:o},[t("el-row",[t("el-col",{attrs:{span:6}},[e._v(e._s(r.create_time))]),e._v(" "),t("el-col",{attrs:{span:3}},[e._v(e._s(r.ops_user))]),e._v(" "),t("el-col",{attrs:{span:4}},[e._v(e._s(r.status_name))]),e._v(" "),t("el-col",{attrs:{span:4}},[e._v(e._s(r.ops_reply_content))])],1)],1)}),0),e._v(" "),t("el-collapse-item",{attrs:{title:"评论回复",name:"7"}},[e._l(e.workOrderDetail.operation_logs,function(r,o){return t("div",{key:o},[t("el-row",[t("el-col",{attrs:{span:6}},[e._v(e._s(r.create_time))]),e._v(" "),t("el-col",{attrs:{span:3}},[e._v(e._s(r.ops_user))]),e._v(" "),t("el-col",{attrs:{span:4}},[e._v(e._s(r.ops_reply_content))])],1)],1)}),e._v(" "),t("div",{staticStyle:{"margin-top":"20px"}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:14}},[t("el-input",{attrs:{clearable:"",size:"small",placeholder:"请输入内容"},model:{value:e.replyContent,callback:function(r){e.replyContent=r},expression:"replyContent"}})],1),e._v(" "),t("el-col",{attrs:{span:2}},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){return e.handleReplyWorkOrder(e.workOrderDetail.id)}}},[e._v("发 送\n            ")])],1)],1)],1)],2),e._v(" "),t("el-collapse-item",{attrs:{title:"操作",name:"8"}},[t("el-row",{attrs:{gutter:5}},[t("el-col",{attrs:{span:1.5}},[1===e.workOrderDetail.status_code&&null===e.workOrderDetail.audit_flow[0].status_code?t("el-button",{attrs:{type:"primary",size:"mini",disabled:""},on:{click:function(r){return e.handleReEditWorkOrderOperation(e.workOrderDetail.id)}}},[e._v("重新编辑\n          ")]):e._e()],1),e._v(" "),t("el-col",{attrs:{span:1.5}},[2===e.workOrderDetail.status_code&&null===e.workOrderDetail.audit_flow[0].status_code?t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(r){return e.handleCancelWorkOrderOperation(e.workOrderDetail.id)}}},[e._v("撤 回\n          ")]):t("el-button",{attrs:{type:"danger",size:"mini",disabled:""},on:{click:function(r){return e.handleCancelWorkOrderOperation(e.workOrderDetail.id)}}},[e._v("撤 回\n          ")])],1),e._v(" "),t("el-col",{attrs:{span:1.5}},[7===e.workOrderDetail.status_code||6===e.workOrderDetail.status_code||8===e.workOrderDetail.status_code?t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.handleConfirmWorkOrderOperation(e.workOrderDetail.id)}}},[e._v("确 认\n          ")]):e._e()],1)],1)],1)],1)],1)},staticRenderFns:[]};var c={name:"MyWorkOrderList",components:{workOrderDetail:t("/Xao")(l,d,!1,function(e){t("cyZq")},"data-v-ab87d8b6",null).exports},props:["workOrderTaskList","taskTotalNum","workOrderModelList","loading","productList","projectList"],data:function(){return{workOrderTaskDetailVisible:!1,updateWorkOrderTaskVisible:!1,workOrderTaskVisible:!1,workOrderEnvTypeList:[{id:1,name:"前端"},{id:0,name:"后台"},{id:2,name:"安卓"}],workOrderDetail:{},fileList:[],addWorkOrderTaskForm:{order_title:"",order_purpose:"",order_files:"",order_env_type:[],order_products:"",order_project:"",order_status:1,template_order_model:""},editWorkOrderTaskForm:{id:"",order_title:"",order_task_id:"",order_purpose:"",order_files:"",order_env_type:[],order_products:"",order_project:"",order_status:1,template_order_model:""},searchForm:{order_task_id:"",order_title:"",template_order_model:"",create_time_before:"",create_time_after:"",page:1,page_size:5},workOrderOperationForm:{ops_status:"",work_order:""},pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var r=new Date,t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",[t,r])}},{text:"最近一个月",onClick:function(e){var r=new Date,t=new Date;t.setTime(t.getTime()-2592e6),e.$emit("pick",[t,r])}},{text:"最近三个月",onClick:function(e){var r=new Date,t=new Date;t.setTime(t.getTime()-7776e6),e.$emit("pick",[t,r])}}]},dateValue:"",upLoadUrl:"",oldValue:"",rules:{order_title:[{required:!0,message:"请输入工单标题",trigger:"blur"}],order_purpose:[{required:!0,message:"请输入需求描述",trigger:"blur"}],template_order_model:[{required:!0,message:"请选择工单类型",trigger:"change"}],order_env_type:[{required:!0,message:"请至少选择一个平台环境类型",trigger:"change"}],order_products:[{required:!0,message:"请选择资源环境类型",trigger:"change"}],order_project:[{required:!0,message:"请选择项目",trigger:"change"}]}}},methods:{handleRemove:function(e,r){console.log(e,r)},handleFileChange:function(e,r){if(r.length>0){var t=r[r.length-1];this.fileList=[t],this.addWorkOrderTaskForm.order_files=t.raw}else this.fileList=[]},handleUpdateFileChange:function(e,r){if(r.length>0){var t=r[r.length-1];this.fileList=[t],this.editWorkOrderTaskForm.order_files=t.raw}else this.fileList=[]},handleRefresh:function(){this.$emit("refresh")},handleFilter:function(){null===this.dateValue||""===this.dateValue||0===this.dateValue.length?(this.searchForm.create_time_before="",this.searchForm.create_time_after=""):(this.searchForm.create_time_before=this.dateValue[1],this.searchForm.create_time_after=this.dateValue[0]),this.$emit("handleSearchTask",this.searchForm)},paginationChange:function(e){this.searchForm.page=e,this.handleFilter()},checkWorkOrderTaskDetail:function(e){this.workOrderTaskDetailVisible=!0,this.workOrderDetail=e},restOrderField:function(){this.workOrderTaskDetailVisible=!1,this.$refs.workOrderDetail.resetFields()},handleAddWorkOrderTask:function(){this.workOrderTaskVisible=!0,void 0!==this.$refs.addWorkOrderTaskForm&&this.$refs.addWorkOrderTaskForm.resetFields()},handleCommitAddWorkOrderTask:function(){var e=this;this.$refs.addWorkOrderTaskForm.validate(function(r){if(r){console.log("addWorkOrderTaskForm",e.addWorkOrderTaskForm);var t=new FormData;t.append("order_title",e.addWorkOrderTaskForm.order_title),t.append("order_purpose",e.addWorkOrderTaskForm.order_purpose),t.append("order_env_type",e.addWorkOrderTaskForm.order_env_type.toString()),t.append("order_products",e.addWorkOrderTaskForm.order_products),t.append("order_project",e.addWorkOrderTaskForm.order_project),t.append("order_status",e.addWorkOrderTaskForm.order_status),t.append("template_order_model",e.addWorkOrderTaskForm.template_order_model),t.append("order_files",e.addWorkOrderTaskForm.order_files),console.log(t),e.$emit("handleCommitAddWorkOrderTask",t),e.workOrderTaskVisible=!1}})},replyWorkOrderTaskForm:function(e){var r=this;Object(o.f)(e).then(function(e){r.$message({message:"操作成功",type:"success"}),r.workOrderTaskDetailVisible=!1,r.fetchData()})},handleWorkOrderOperation:function(e){var r=this;Object(o.f)(e).then(function(e){r.$message({message:"操作成功",type:"success"}),r.workOrderTaskDetailVisible=!1,r.$emit("refresh")})},submitWorkOrderTaskDetail:function(e){var r=this;this.workOrderOperationForm.ops_status=1,this.workOrderOperationForm.work_order=e.id,Object(o.f)(this.workOrderOperationForm).then(function(){r.$message({message:"提交成功",type:"success"}),r.updateWorkOrderTaskVisible=!1,r.$emit("refresh")})},submitWorkOrderTaskDetailInUpdateForm:function(){var e=this;this.workOrderOperationForm.ops_status=1,this.workOrderOperationForm.work_order=this.editWorkOrderTaskForm.id,Object(o.f)(this.workOrderOperationForm).then(function(){e.$message({message:"提交成功",type:"success"}),e.updateWorkOrderTaskVisible=!1,e.$emit("refresh")})},editWorkOrderTaskDetail:function(e){console.log(e),this.updateWorkOrderTaskVisible=!0,console.log("env type",e.order_env_type),console.log("edit order type",i()(e.order_files));var r=e.id,t=e.order_title,o=e.order_task_id,n=e.status_code,a=e.order_purpose,s=e.order_products,l=e.order_env_type,d=e.order_project,c=e.order_files,p=e.template_order_model;this.editWorkOrderTaskForm={id:r,order_title:t,order_task_id:o,order_status:n,order_purpose:a,order_products:s,order_env_type:l,order_project:d,order_files:c,template_order_model:p},this.oldValue=e.order_files},handleCommitUpdateWorkOrderTask:function(){var e=this;if(this.oldValue===this.editWorkOrderTaskForm.order_files){delete this.editWorkOrderTaskForm.order_files;var r=[];this.editWorkOrderTaskForm.order_env_type.forEach(function(e){r.push(e.name)}),console.log("in else",r),this.editWorkOrderTaskForm.order_env_type=r.toString(),Object(o.E)(this.editWorkOrderTaskForm.id,this.editWorkOrderTaskForm).then(function(){e.updateWorkOrderTaskVisible=!1,e.$message({message:"修改成功",type:"success"}),e.$emit("refresh")})}else{console.log("editWorkOrderTaskForm status",this.editWorkOrderTaskForm);var t=new FormData;t.append("order_title",this.editWorkOrderTaskForm.order_title),t.append("order_task_id",this.editWorkOrderTaskForm.order_task_id),t.append("order_purpose",this.editWorkOrderTaskForm.order_purpose);var n=[];this.editWorkOrderTaskForm.order_env_type.forEach(function(e){n.push(e.name)}),console.log("in else",n),this.editWorkOrderTaskForm.order_env_type=n.toString(),t.append("order_env_type",this.editWorkOrderTaskForm.order_env_type),t.append("order_products",this.editWorkOrderTaskForm.order_products),t.append("order_project",this.editWorkOrderTaskForm.order_project),t.append("order_status",this.editWorkOrderTaskForm.order_status),t.append("template_order_model",this.editWorkOrderTaskForm.template_order_model),t.append("order_files",this.editWorkOrderTaskForm.order_files),console.log("ordef_file type",i()(this.editWorkOrderTaskForm.order_files)),Object(o.E)(this.editWorkOrderTaskForm.id,t).then(function(){e.updateWorkOrderTaskVisible=!1,e.$message({message:"修改成功",type:"success"}),e.$emit("refresh")})}}}},p={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"app-container"},[t("div",{staticClass:"filter-container"},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:3}},[t("el-select",{attrs:{size:"small",placeholder:"工单类型","default-first-option":""},model:{value:e.searchForm.template_order_model,callback:function(r){e.$set(e.searchForm,"template_order_model",r)},expression:"searchForm.template_order_model"}},e._l(e.workOrderModelList,function(e,r){return t("el-option",{key:r,attrs:{label:e.model_name,value:e.id}})}),1)],1),e._v(" "),t("el-col",{attrs:{span:6}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{size:"small",type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.dateValue,callback:function(r){e.dateValue=r},expression:"dateValue"}})],1),e._v(" "),t("el-col",{attrs:{span:4}},[t("el-input",{attrs:{size:"small",placeholder:"工单编号"},nativeOn:{keyup:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"enter",13,r.key,"Enter")?null:e.handleFilter(r)}},model:{value:e.searchForm.order_task_id,callback:function(r){e.$set(e.searchForm,"order_task_id",r)},expression:"searchForm.order_task_id"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleFilter},slot:"append"})],1)],1)],1)],1),e._v(" "),t("div",{staticClass:"filter-container",staticStyle:{"margin-bottom":"10px","margin-top":"20px",position:"relative"}},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:18}},[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.handleAddWorkOrderTask}},[e._v("新建工单")]),e._v(" "),t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh"},on:{click:e.handleRefresh}},[e._v("刷 新")])],1),e._v(" "),t("el-col",{attrs:{span:6}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.taskTotalNum>=0,expression:"taskTotalNum>=0"}],attrs:{background:"","pager-count":5,size:"mini","page-size":e.searchForm.page_size,layout:"total, prev, pager, next, jumper","current-page":e.searchForm.page,total:e.taskTotalNum},on:{"current-change":e.paginationChange,"update:currentPage":function(r){return e.$set(e.searchForm,"page",r)},"update:current-page":function(r){return e.$set(e.searchForm,"page",r)}}})],1)],1)],1),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.workOrderTaskList,"highlight-current-row":"",border:""}},[t("el-table-column",{attrs:{label:"工单 ID",prop:"order_task_id",align:"center",width:"180px"}}),e._v(" "),t("el-table-column",{attrs:{label:"工单标题",prop:"order_title",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"工单类型",prop:"order_model",width:"100px",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"产品线",prop:"order_product_name",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"项目名称",prop:"order_project_name",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"平台",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){return e._l(r.row.order_env_type,function(r){return t("span",[t("el-tag",{attrs:{size:"mini"}},[e._v(" "+e._s(r.name))]),e._v(" "),t("span")],1)})}}])}),e._v(" "),t("el-table-column",{attrs:{label:"当前执行",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){return[e._v("\n        "+e._s(r.row.current_exec_user||"——")+"\n      ")]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"当前审核",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){return[e._v("\n        "+e._s(r.row.current_audit_user||"——")+"\n      ")]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"最近更新",prop:"update_time",width:"160px",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"工单状态",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-tag",[e._v(e._s(r.row.status_name)+" ")])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{type:"primary",plain:"",size:"mini",icon:"el-icon-document",circle:""},on:{click:function(t){return e.checkWorkOrderTaskDetail(r.row)}}}),e._v(" "),1===r.row.status_code?t("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(t){return e.editWorkOrderTaskDetail(r.row)}}}):e._e(),e._v(" "),1===r.row.status_code?t("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-check",circle:""},on:{click:function(t){return e.submitWorkOrderTaskDetail(r.row)}}}):e._e()]}}])})],1),e._v(" "),t("el-dialog",{attrs:{visible:e.workOrderTaskDetailVisible,width:"70%",center:""},on:{"update:visible":function(r){e.workOrderTaskDetailVisible=r},closed:e.restOrderField}},[t("template",{slot:"title"},[t("span",[t("h3",[e._v("工单详情")])])]),e._v(" "),t("work-order-detail",{attrs:{workOrderDetail:e.workOrderDetail},on:{replyWorkOrderTaskForm:e.replyWorkOrderTaskForm,handleWorkOrderOperation:e.handleWorkOrderOperation}})],2),e._v(" "),t("el-dialog",{attrs:{title:"新建工单",center:"",visible:e.workOrderTaskVisible,width:"40%"},on:{"update:visible":function(r){e.workOrderTaskVisible=r}}},[t("el-form",{ref:"addWorkOrderTaskForm",attrs:{rules:e.rules,model:e.addWorkOrderTaskForm,"label-width":"110px"}},[t("el-form-item",{attrs:{label:"工单标题",prop:"order_title"}},[t("el-input",{attrs:{placeholder:"请输入工单标题"},model:{value:e.addWorkOrderTaskForm.order_title,callback:function(r){e.$set(e.addWorkOrderTaskForm,"order_title",r)},expression:"addWorkOrderTaskForm.order_title"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"工单需求",prop:"order_purpose"}},[t("el-input",{attrs:{type:"textarea",rows:8,placeholder:"请输入工单需求"},model:{value:e.addWorkOrderTaskForm.order_purpose,callback:function(r){e.$set(e.addWorkOrderTaskForm,"order_purpose",r)},expression:"addWorkOrderTaskForm.order_purpose"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"工单类型",prop:"template_order_model"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择工单类型"},model:{value:e.addWorkOrderTaskForm.template_order_model,callback:function(r){e.$set(e.addWorkOrderTaskForm,"template_order_model",r)},expression:"addWorkOrderTaskForm.template_order_model"}},e._l(e.workOrderModelList,function(e,r){return t("el-option",{key:r,attrs:{label:e.model_name,value:e.id}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"平台环境类型",prop:"order_env_type"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择平台环境类型"},model:{value:e.addWorkOrderTaskForm.order_env_type,callback:function(r){e.$set(e.addWorkOrderTaskForm,"order_env_type",r)},expression:"addWorkOrderTaskForm.order_env_type"}},e._l(e.workOrderEnvTypeList,function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"资源环境类型",prop:"order_products"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择资源环境类型"},model:{value:e.addWorkOrderTaskForm.order_products,callback:function(r){e.$set(e.addWorkOrderTaskForm,"order_products",r)},expression:"addWorkOrderTaskForm.order_products"}},e._l(e.productList,function(e,r){return t("el-option",{key:r,attrs:{label:e.service_name,value:e.id}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"项目",prop:"order_project"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择项目"},model:{value:e.addWorkOrderTaskForm.order_project,callback:function(r){e.$set(e.addWorkOrderTaskForm,"order_project",r)},expression:"addWorkOrderTaskForm.order_project"}},e._l(e.projectList,function(e,r){return t("el-option",{key:r,attrs:{label:e.project_name,value:e.id}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"附件",prop:"order_files"}},[t("el-upload",{ref:"upload",attrs:{action:e.upLoadUrl,"on-remove":e.handleRemove,"on-change":e.handleFileChange,"file-list":e.fileList,"auto-upload":!1}},[t("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),e._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("如内容较多可上传文件")])],1)],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleCommitAddWorkOrderTask}},[e._v("立即创建")]),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:function(r){e.workOrderTaskVisible=!1}}},[e._v("取消")])],1)],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"编辑",center:"",visible:e.updateWorkOrderTaskVisible,width:"40%"},on:{"update:visible":function(r){e.updateWorkOrderTaskVisible=r}}},[t("el-form",{ref:"editWorkOrderTaskForm",attrs:{model:e.editWorkOrderTaskForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"工单id"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editWorkOrderTaskForm.order_task_id,callback:function(r){e.$set(e.editWorkOrderTaskForm,"order_task_id",r)},expression:"editWorkOrderTaskForm.order_task_id"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"工单标题"}},[t("el-input",{attrs:{placeholder:"请输入工单标题"},model:{value:e.editWorkOrderTaskForm.order_title,callback:function(r){e.$set(e.editWorkOrderTaskForm,"order_title",r)},expression:"editWorkOrderTaskForm.order_title"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"工单需求"}},[t("el-input",{attrs:{type:"textarea",rows:8,placeholder:"请输入工单需求"},model:{value:e.editWorkOrderTaskForm.order_purpose,callback:function(r){e.$set(e.editWorkOrderTaskForm,"order_purpose",r)},expression:"editWorkOrderTaskForm.order_purpose"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"工单类型"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择工单类型"},model:{value:e.editWorkOrderTaskForm.template_order_model,callback:function(r){e.$set(e.editWorkOrderTaskForm,"template_order_model",r)},expression:"editWorkOrderTaskForm.template_order_model"}},e._l(e.workOrderModelList,function(e,r){return t("el-option",{key:r,attrs:{label:e.model_name,value:e.id}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"平台环境类型",prop:"order_env_type"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择平台环境类型"},model:{value:e.editWorkOrderTaskForm.order_env_type,callback:function(r){e.$set(e.editWorkOrderTaskForm,"order_env_type",r)},expression:"editWorkOrderTaskForm.order_env_type"}},e._l(e.workOrderEnvTypeList,function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"资源环境类型",prop:"editWorkOrderTaskForm.order_products"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择资源环境类型"},model:{value:e.editWorkOrderTaskForm.order_products,callback:function(r){e.$set(e.editWorkOrderTaskForm,"order_products",r)},expression:"editWorkOrderTaskForm.order_products"}},e._l(e.productList,function(e,r){return t("el-option",{key:r,attrs:{label:e.service_name,value:e.id}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"项目",prop:"editWorkOrderTaskForm.order_project"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择项目"},model:{value:e.editWorkOrderTaskForm.order_project,callback:function(r){e.$set(e.editWorkOrderTaskForm,"order_project",r)},expression:"editWorkOrderTaskForm.order_project"}},e._l(e.projectList,function(e,r){return t("el-option",{key:r,attrs:{label:e.project_name,value:e.id}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"上传附件",prop:"order_files"}},[t("el-input",{attrs:{size:"mini",disabled:""},model:{value:e.editWorkOrderTaskForm.order_files,callback:function(r){e.$set(e.editWorkOrderTaskForm,"order_files",r)},expression:"editWorkOrderTaskForm.order_files"}}),e._v(" "),t("el-upload",{ref:"upload",attrs:{action:e.upLoadUrl,"on-remove":e.handleRemove,"on-change":e.handleUpdateFileChange,"file-list":e.fileList,"auto-upload":!1}},[t("el-button",{attrs:{slot:"trigger",size:"mini",type:"primary"},slot:"trigger"},[e._v("选取文件")]),e._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("如内容较多可上传文件")])],1)],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleCommitUpdateWorkOrderTask}},[e._v("保 存")]),e._v(" "),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submitWorkOrderTaskDetailInUpdateForm}},[e._v("提 交")]),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:function(r){e.updateWorkOrderTaskVisible}}},[e._v("取 消")])],1)],1)],1)],1)},staticRenderFns:[]};var _=t("/Xao")(c,p,!1,function(e){t("qJ7+")},"data-v-103bde3e",null).exports,u={name:"toDoWorkOrderDetail",props:["workOrderDetail","loading"],data:function(){return{activeNames:["1","2","3","4","8"],replyContent:"",replyWorkOrderTaskForm:{ops_status:15,ops_reply_content:"",work_order:""},workOrderOperationForm:{ops_status:"",work_order:"",ops_reply_content:""}}},methods:{handleChange:function(e){console.log(e)},getElementIndex:function(e,r){if(null!==r){for(var t=[],o=0;o<e.length;o++)t.push(e[o].exec_user);return t.indexOf(r.exec_user)+1}},downloadAttachment:function(e){window.location.href=e},handleReplyWorkOrder:function(e){this.replyWorkOrderTaskForm.ops_reply_content=this.replyContent,this.replyWorkOrderTaskForm.work_order=e,this.$emit("replyWorkOrderTaskForm",this.replyWorkOrderTaskForm),this.replyContent=""},handleDeferWorkOrderOperation:function(e){this.workOrderOperationForm.ops_status=7,this.workOrderOperationForm.work_order=e,this.workOrderOperationForm.ops_reply_content="",this.$emit("handleWorkOrderOperation",this.workOrderOperationForm)},handleExecWorkOrderOperation:function(e){this.workOrderOperationForm.ops_status=5,this.workOrderOperationForm.work_order=e,this.workOrderOperationForm.ops_reply_content="",this.$emit("handleWorkOrderOperation",this.workOrderOperationForm)},handleCompleteWorkOrderOperation:function(e){this.workOrderOperationForm.ops_status=8,this.workOrderOperationForm.work_order=e,this.workOrderOperationForm.ops_reply_content=this.replyContent,this.$emit("handleWorkOrderOperation",this.workOrderOperationForm)}}},k={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"components-container"},[t("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(r){e.activeNames=r},expression:"activeNames"}},[t("el-collapse-item",{attrs:{title:"基础信息",name:"1"}},[t("el-row",[t("el-col",{attrs:{span:2}},[t("table",[t("tr",[t("td",[e._v("工单标题")])]),e._v(" "),t("tr",[t("td",[e._v("工单状态")])]),e._v(" "),t("tr",[t("td",[e._v("项目名称")])]),e._v(" "),t("tr",[t("td",[e._v("当前审核人")])]),e._v(" "),t("tr",[t("td",[e._v("当前执行人")])]),e._v(" "),t("tr",[t("td",[e._v("附件")])])])]),e._v(" "),t("el-col",{attrs:{span:6}},[t("table",[t("tr",[t("td",[e._v(e._s(e.workOrderDetail.order_title))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.status_name))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.order_project_name))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.current_audit_user||"暂无"))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.current_exec_user||"暂无"))])]),e._v(" "),t("tr",[t("td",[null!==e.workOrderDetail.download_url?t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){return e.downloadAttachment(e.workOrderDetail.download_url)}}},[e._v("\n                下载\n              ")]):e._e()],1)])])]),e._v(" "),t("el-col",{attrs:{span:2}},[t("table",[t("tr",[t("td",[e._v("工单ID")])]),e._v(" "),t("tr",[t("td",[e._v("产品线")])]),e._v(" "),t("tr",[t("td",[e._v("平台")])]),e._v(" "),t("tr",[t("td",[e._v("创建时间")])]),e._v(" "),t("tr",[t("td",[e._v("更新时间")])])])]),e._v(" "),t("el-col",{attrs:{span:8}},[t("table",[t("tr",[t("td",[e._v(e._s(e.workOrderDetail.order_task_id))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.order_product_name))])]),e._v(" "),t("tr",[t("td",e._l(e.workOrderDetail.order_env_type,function(r){return t("span",[t("el-tag",{attrs:{size:"mini",type:"success"}},[e._v(e._s(r.name))]),e._v(" "),t("span")],1)}),0)]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.create_time))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.update_time))])])])])],1)],1),e._v(" "),t("el-collapse-item",{attrs:{title:"工单需求",name:"2"}},[t("div",[e._v(e._s(e.workOrderDetail.order_purpose))])]),e._v(" "),t("el-collapse-item",{attrs:{title:"工单结果",name:"3"}},[t("div",[e._v(e._s(e.workOrderDetail.order_result))])]),e._v(" "),t("el-collapse-item",{attrs:{title:"执行信息",name:"5"}},[t("el-steps",{attrs:{"finish-status":"success","process-status":"wait",space:200,active:e.getElementIndex(e.workOrderDetail.exec_flow,e.workOrderDetail.current_exec_flow)}},e._l(e.workOrderDetail.exec_flow,function(e,r){return t("el-step",{key:r,attrs:{icon:"el-icon-user-solid",title:e.exec_user,description:e.status_name}})}),1)],1),e._v(" "),t("el-collapse-item",{attrs:{title:"操作记录",name:"6"}},e._l(e.workOrderDetail.operation_records,function(r,o){return t("div",{key:o},[t("el-row",[t("el-col",{attrs:{span:6}},[e._v(e._s(r.create_time))]),e._v(" "),t("el-col",{attrs:{span:3}},[e._v(e._s(r.ops_user))]),e._v(" "),t("el-col",{attrs:{span:4}},[e._v(e._s(r.status_name))]),e._v(" "),t("el-col",{attrs:{span:4}},[e._v(e._s(r.ops_reply_content))])],1)],1)}),0),e._v(" "),t("el-collapse-item",{attrs:{title:"评论回复",name:"7"}},[e._l(e.workOrderDetail.operation_logs,function(r,o){return t("div",{key:o},[t("el-row",[t("el-col",{attrs:{span:6}},[e._v(e._s(r.create_time))]),e._v(" "),t("el-col",{attrs:{span:3}},[e._v(e._s(r.ops_user))]),e._v(" "),t("el-col",{attrs:{span:4}},[e._v(e._s(r.ops_reply_content))])],1)],1)}),e._v(" "),t("div",{staticStyle:{"margin-top":"20px"}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:14}},[t("el-input",{attrs:{clearable:"",size:"small",placeholder:"请输入内容"},model:{value:e.replyContent,callback:function(r){e.replyContent=r},expression:"replyContent"}})],1),e._v(" "),t("el-col",{attrs:{span:2}},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){return e.handleReplyWorkOrder(e.workOrderDetail.id)}}},[e._v("发送\n            ")])],1)],1)],1)],2),e._v(" "),t("el-collapse-item",{attrs:{title:"操作",name:"8"}},[t("el-row",[t("el-col",[t("div",[e.workOrderDetail.exec_flow[e.workOrderDetail.exec_flow.length-1].exec_user!==this.$store.getters.username||4!==e.workOrderDetail.status_code&&5!==e.workOrderDetail.status_code?e._e():t("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入执行结果",clearable:""},model:{value:e.replyContent,callback:function(r){e.replyContent=r},expression:"replyContent"}})],1)])],1),e._v(" "),t("el-row",{attrs:{gutter:5}},[t("el-col",{attrs:{span:1.5}},[3===e.workOrderDetail.status_code&&this.$store.getters.username===e.workOrderDetail.current_exec_user?t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.handleExecWorkOrderOperation(e.workOrderDetail.id)}}},[e._v("确认执行\n          ")]):e._e()],1),e._v(" "),t("el-col",{attrs:{span:1.5}},[4===e.workOrderDetail.status_code?t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.handleDeferWorkOrderOperation(e.workOrderDetail.id)}}},[e._v("延期执行\n          ")]):e._e()],1),e._v(" "),t("el-col",{attrs:{span:1.5}},[3===e.workOrderDetail.status_code&&this.$store.getters.username===e.workOrderDetail.current_exec_user?t("el-button",{attrs:{type:"primary",size:"mini",disabled:""},on:{click:function(r){return e.handleCompleteWorkOrderOperation(e.workOrderDetail.id)}}},[e._v("执行转发\n          ")]):e._e()],1),e._v(" "),t("el-col",{attrs:{span:1.5}},[4!==e.workOrderDetail.status_code&&5!==e.workOrderDetail.status_code||this.$store.getters.username!==e.workOrderDetail.current_exec_user?t("el-button",{attrs:{type:"primary",size:"mini",disabled:""}},[e._v("执行完成\n          ")]):t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.handleCompleteWorkOrderOperation(e.workOrderDetail.id)}}},[e._v("执行完成\n          ")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var m={name:"toDoWorkOrderList",props:["execWorkOrderTaskList","toDoListLoading","taskToDoTotalNum"],components:{toDoWorkOrderDetail:t("/Xao")(u,k,!1,function(e){t("QKGL")},"data-v-068ecdf6",null).exports},data:function(){return{workOrderTaskDetailVisible:!1,workOrderDetail:{},searchForm:{page:1,page_size:5}}},methods:{handleRefresh:function(){this.$emit("refreshToDoList",this.searchForm)},paginationChange:function(e){this.searchForm.page=e,this.handleRefresh()},restOrderField:function(){this.workOrderTaskDetailVisible=!1,this.$refs[this.workOrderDetail].resetFields()},checkWorkOrderTaskDetail:function(e){this.workOrderTaskDetailVisible=!0,this.workOrderDetail=e},replyWorkOrderTaskForm:function(e){var r=this;Object(o.f)(e).then(function(e){r.$message({message:"操作成功",type:"success"}),r.workOrderTaskDetailVisible=!1,r.fetchData()})},handleWorkOrderOperation:function(e){var r=this;Object(o.f)(e).then(function(e){r.$message({message:"操作成功",type:"success"}),r.workOrderTaskDetailVisible=!1,r.$emit("refreshToDoList")})}}},v={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"app-container"},[t("div",{staticClass:"filter-container",staticStyle:{"margin-bottom":"10px","margin-top":"20px",position:"relative"}},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:18}},[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh"},on:{click:e.handleRefresh}},[e._v("刷 新")])],1),e._v(" "),t("el-col",{attrs:{span:6}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.taskToDoTotalNum>0,expression:"taskToDoTotalNum>0"}],attrs:{background:"","pager-count":5,"page-size":e.searchForm.page_size,layout:"total, prev, pager, next, jumper","current-page":e.searchForm.page,total:e.taskToDoTotalNum},on:{"current-change":e.paginationChange,"update:currentPage":function(r){return e.$set(e.searchForm,"page",r)},"update:current-page":function(r){return e.$set(e.searchForm,"page",r)}}})],1)],1)],1),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.toDoListLoading,expression:"toDoListLoading"}],attrs:{data:e.execWorkOrderTaskList,"highlight-current-row":"",border:""}},[t("el-table-column",{attrs:{label:"工单id",prop:"order_task_id",align:"center",width:"180px"}}),e._v(" "),t("el-table-column",{attrs:{label:"工单标题",prop:"order_title",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"工单类型",prop:"order_model",width:"100px",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"产品线",prop:"order_product_name",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"项目名称",prop:"order_project_name",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"平台",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){return e._l(r.row.order_env_type,function(r){return t("span",[t("el-tag",{attrs:{size:"mini"}},[e._v(" "+e._s(r.name))]),e._v(" "),t("span")],1)})}}])}),e._v(" "),t("el-table-column",{attrs:{label:"当前执行",prop:"current_exec_user",width:"80px",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"最近更新",prop:"update_time",width:"160px",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"工单状态",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-tag",[e._v(e._s(r.row.status_name)+" ")])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{type:"primary",plain:"",size:"mini",icon:"el-icon-document",circle:""},on:{click:function(t){return e.checkWorkOrderTaskDetail(r.row)}}})]}}])})],1),e._v(" "),t("el-dialog",{attrs:{visible:e.workOrderTaskDetailVisible,width:"70%",center:""},on:{"update:visible":function(r){e.workOrderTaskDetailVisible=r}}},[t("template",{slot:"title"},[t("span",[t("h3",[e._v("工 单 详 情")])])]),e._v(" "),t("to-do-work-order-detail",{attrs:{workOrderDetail:e.workOrderDetail},on:{replyWorkOrderTaskForm:e.replyWorkOrderTaskForm,handleWorkOrderOperation:e.handleWorkOrderOperation}})],2)],1)},staticRenderFns:[]};var O=t("/Xao")(m,v,!1,function(e){t("VJN1")},"data-v-35c9dffc",null).exports,h={name:"workOrderDetail",props:["workOrderDetail"],data:function(){return{activeNames:["1","2","3","4","8"],replyContent:"",replyWorkOrderTaskForm:{ops_status:15,ops_reply_content:"",work_order:""},workOrderOperationForm:{ops_status:"",work_order:""}}},methods:{handleChange:function(e){console.log(e)},getElementIndex:function(e,r){if(null!==r){for(var t=[],o=0;o<e.length;o++)t.push(e[o].exec_user);return t.indexOf(r.exec_user)+1}},downloadAttachment:function(e){window.location.href=e},handleReplyWorkOrder:function(e){this.replyWorkOrderTaskForm.ops_reply_content=this.replyContent,this.replyWorkOrderTaskForm.work_order=e,this.$emit("replyWorkOrderTaskForm",this.replyWorkOrderTaskForm),this.replyContent=""},handleRefuselWorkOrderOperation:function(e){this.workOrderOperationForm.ops_status=3,this.workOrderOperationForm.work_order=e,this.$emit("handleWorkOrderOperation",this.workOrderOperationForm)},handleTransmitWorkOrderOperation:function(e){this.workOrderOperationForm.ops_status=4,this.workOrderOperationForm.work_order=e,this.$emit("handleWorkOrderOperation",this.workOrderOperationForm)},handlePassWorkOrderOperation:function(e){this.workOrderOperationForm.ops_status=2,this.workOrderOperationForm.work_order=e,this.$emit("handleWorkOrderOperation",this.workOrderOperationForm)}}},f={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"components-container"},[t("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(r){e.activeNames=r},expression:"activeNames"}},[t("el-collapse-item",{attrs:{title:"基础信息",name:"1"}},[t("el-row",[t("el-col",{attrs:{span:2}},[t("table",[t("tr",[t("td",[e._v("工单标题")])]),e._v(" "),t("tr",[t("td",[e._v("工单状态")])]),e._v(" "),t("tr",[t("td",[e._v("项目名称")])]),e._v(" "),t("tr",[t("td",[e._v("当前审核人")])]),e._v(" "),t("tr",[t("td",[e._v("当前执行人")])]),e._v(" "),t("tr",[t("td",[e._v("附件")])])])]),e._v(" "),t("el-col",{attrs:{span:6}},[t("table",[t("tr",[t("td",[e._v(e._s(e.workOrderDetail.order_title))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.status_name))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.order_project_name))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.current_audit_user||"暂无"))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.current_exec_user||"暂无"))])]),e._v(" "),t("tr",[t("td",[null!==e.workOrderDetail.download_url?t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){return e.downloadAttachment(e.workOrderDetail.download_url)}}},[e._v("\n                下载\n              ")]):e._e()],1)])])]),e._v(" "),t("el-col",{attrs:{span:2}},[t("table",[t("tr",[t("td",[e._v("工单ID")])]),e._v(" "),t("tr",[t("td",[e._v("产品线")])]),e._v(" "),t("tr",[t("td",[e._v("平台")])]),e._v(" "),t("tr",[t("td",[e._v("创建时间")])]),e._v(" "),t("tr",[t("td",[e._v("更新时间")])])])]),e._v(" "),t("el-col",{attrs:{span:8}},[t("table",[t("tr",[t("td",[e._v(e._s(e.workOrderDetail.order_task_id))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.order_product_name))])]),e._v(" "),t("tr",[t("td",e._l(e.workOrderDetail.order_env_type,function(r){return t("span",[t("el-tag",{attrs:{size:"mini",type:"success"}},[e._v(e._s(r.name))]),e._v(" "),t("span")],1)}),0)]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.create_time))])]),e._v(" "),t("tr",[t("td",[e._v(e._s(e.workOrderDetail.update_time))])])])])],1)],1),e._v(" "),t("el-collapse-item",{attrs:{title:"工单需求",name:"2"}},[t("div",[e._v(e._s(e.workOrderDetail.order_purpose))])]),e._v(" "),t("el-collapse-item",{attrs:{title:"工单结果",name:"3"}},[t("div",[e._v(e._s(e.workOrderDetail.order_result))])]),e._v(" "),t("el-collapse-item",{attrs:{title:"审核信息",name:"4"}},[t("el-steps",{attrs:{"finish-status":"success","process-status":"wait",space:200,active:e.getElementIndex(e.workOrderDetail.audit_flow,e.workOrderDetail.current_audit_flow)}},e._l(e.workOrderDetail.audit_flow,function(e,r){return t("el-step",{key:r,attrs:{icon:"el-icon-user-solid",title:e.exec_user,description:e.status_name}})}),1)],1),e._v(" "),t("el-collapse-item",{attrs:{title:"操作记录",name:"6"}},e._l(e.workOrderDetail.operation_records,function(r,o){return t("div",{key:o},[t("el-row",[t("el-col",{attrs:{span:"6"}},[e._v(e._s(r.create_time))]),e._v(" "),t("el-col",{attrs:{span:"3"}},[e._v(e._s(r.ops_user))]),e._v(" "),t("el-col",{attrs:{span:"4"}},[e._v(e._s(r.status_name))]),e._v(" "),t("el-col",{attrs:{span:"4"}},[e._v(e._s(r.ops_reply_content))])],1)],1)}),0),e._v(" "),t("el-collapse-item",{attrs:{title:"评论回复",name:"7"}},[e._l(e.workOrderDetail.operation_logs,function(r,o){return t("div",{key:o},[t("el-row",[t("el-col",{attrs:{span:"6"}},[e._v(e._s(r.create_time))]),e._v(" "),t("el-col",{attrs:{span:"3"}},[e._v(e._s(r.ops_user))]),e._v(" "),t("el-col",{attrs:{span:"4"}},[e._v(e._s(r.ops_reply_content))])],1)],1)}),e._v(" "),t("div",{staticStyle:{"margin-top":"20px"}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:14}},[t("el-input",{attrs:{clearable:"",size:"small",placeholder:"请输入内容"},model:{value:e.replyContent,callback:function(r){e.replyContent=r},expression:"replyContent"}})],1),e._v(" "),t("el-col",{attrs:{span:2}},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){return e.handleReplyWorkOrder(e.workOrderDetail.id)}}},[e._v("发送\n            ")])],1)],1)],1)],2),e._v(" "),t("el-collapse-item",{attrs:{title:"操作",name:"8"}},[t("el-row",{attrs:{gutter:5}},[t("el-col",{attrs:{span:1.5}},[2===e.workOrderDetail.status_code&&this.$store.getters.username===e.workOrderDetail.current_audit_user?t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.handlePassWorkOrderOperation(e.workOrderDetail.id)}}},[e._v("同 意\n          ")]):t("el-button",{attrs:{disabled:"",type:"primary",size:"mini"},on:{click:function(r){return e.handlePassWorkOrderOperation(e.workOrderDetail.id)}}},[e._v("同 意\n          ")])],1),e._v(" "),t("el-col",{attrs:{span:1.5}},[2===e.workOrderDetail.status_code&&this.$store.getters.username===e.workOrderDetail.current_audit_user?t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(r){return e.handleRefuselWorkOrderOperation(e.workOrderDetail.id)}}},[e._v("拒 绝\n          ")]):t("el-button",{attrs:{disabled:"",type:"danger",size:"mini"},on:{click:function(r){return e.handleRefuselWorkOrderOperation(e.workOrderDetail.id)}}},[e._v("拒 绝\n          ")])],1),e._v(" "),t("el-col",{attrs:{span:1.5}},[2===e.workOrderDetail.status_code&&this.$store.getters.username===e.workOrderDetail.current_audit_user?t("el-button",{attrs:{type:"primary",size:"mini",disabled:""},on:{click:function(r){return e.handleTransmitWorkOrderOperation(e.workOrderDetail.id)}}},[e._v("转 发\n          ")]):t("el-button",{attrs:{disabled:"",type:"primary",size:"mini"},on:{click:function(r){return e.handleTransmitWorkOrderOperation(e.workOrderDetail.id)}}},[e._v("转 发\n          ")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var w={name:"toAuditWorkOrderList",props:["auditWorkOrderTaskList","auditListLoading","auditTaskTotalNum"],components:{toAuditWorkOrderDetail:t("/Xao")(h,f,!1,function(e){t("AUUv")},"data-v-5394d128",null).exports},data:function(){return{workOrderTaskDetailVisible:!1,workOrderDetail:{},searchForm:{page:1,page_size:5}}},methods:{handleRefresh:function(){this.$emit("auditListRefresh",this.searchForm)},paginationChange:function(e){this.searchForm.page=e,this.handleRefresh()},checkWorkOrderTaskDetail:function(e){this.workOrderTaskDetailVisible=!0,this.workOrderDetail=e},restOrderField:function(){this.workOrderTaskDetailVisible=!1,this.$refs[this.workOrderDetail].resetFields()},replyWorkOrderTaskForm:function(e){var r=this;Object(o.f)(e).then(function(e){r.$message({message:"操作成功",type:"success"}),r.workOrderTaskDetailVisible=!1,r.$emit("auditListRefresh")})},handleWorkOrderOperation:function(e){var r=this;Object(o.f)(e).then(function(e){r.$message({message:"操作成功",type:"success"}),r.workOrderTaskDetailVisible=!1,r.$emit("auditListRefresh")})}}},b={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"app-container"},[t("div",{staticClass:"filter-container",staticStyle:{"margin-bottom":"10px","margin-top":"20px",position:"relative"}},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:18}},[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh"},on:{click:e.handleRefresh}},[e._v("刷 新")])],1),e._v(" "),t("el-col",{attrs:{span:6}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.auditTaskTotalNum>0,expression:"auditTaskTotalNum>0"}],attrs:{background:"","pager-count":5,"page-size":e.searchForm.page_size,layout:"total, prev, pager, next, jumper","current-page":e.searchForm.page,total:e.auditTaskTotalNum},on:{"current-change":e.paginationChange,"update:currentPage":function(r){return e.$set(e.searchForm,"page",r)},"update:current-page":function(r){return e.$set(e.searchForm,"page",r)}}})],1)],1)],1),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.auditListLoading,expression:"auditListLoading"}],attrs:{data:e.auditWorkOrderTaskList,"highlight-current-row":"",border:""}},[t("el-table-column",{attrs:{label:"工单 ID",prop:"order_task_id",align:"center",width:"180px"}}),e._v(" "),t("el-table-column",{attrs:{label:"工单标题",prop:"order_title",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"工单类型",width:"100px",prop:"order_model",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"产品线",prop:"order_product_name",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"项目名称",prop:"order_project_name",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"平台",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){return e._l(r.row.order_env_type,function(r){return t("span",[t("el-tag",{attrs:{size:"mini"}},[e._v(" "+e._s(r.name))]),e._v(" "),t("span")],1)})}}])}),e._v(" "),t("el-table-column",{attrs:{label:"当前审核",prop:"current_audit_user",width:"80px",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"最近更新",width:"160px",prop:"update_time",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"工单状态",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-tag",[e._v(e._s(r.row.status_name)+" ")])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{type:"primary",plain:"",size:"mini",icon:"el-icon-document",circle:""},on:{click:function(t){return e.checkWorkOrderTaskDetail(r.row)}}})]}}])})],1),e._v(" "),t("el-dialog",{attrs:{visible:e.workOrderTaskDetailVisible,width:"70%",center:""},on:{"update:visible":function(r){e.workOrderTaskDetailVisible=r},closed:e.restOrderField}},[t("template",{slot:"title"},[t("span",[t("h3",[e._v("工 单 详 情")])])]),e._v(" "),t("to-audit-work-order-detail",{attrs:{workOrderDetail:e.workOrderDetail},on:{replyWorkOrderTaskForm:e.replyWorkOrderTaskForm,handleWorkOrderOperation:e.handleWorkOrderOperation}})],2)],1)},staticRenderFns:[]};var g={name:"workOrderTask",components:{MyWorkOrderList:_,toDoWorkOrderList:O,toAuditWorkOrderList:t("/Xao")(w,b,!1,function(e){t("B9f7")},"data-v-086ec34e",null).exports},data:function(){return{activeName:"1",workOrderTaskList:[],workOrderTaskCode:[],workOrderOperationCode:[],workOrderModelList:[],execWorkOrderTaskList:[],auditWorkOrderTaskList:[],productList:[],projectList:[],taskTotalNum:0,taskToDoTotalNum:0,auditTaskTotalNum:0,workOrderTaskDetailVisible:!1,workOrderTaskVisible:!1,loading:!1,toDoListLoading:!1,auditListLoading:!1,searchForm:{page:1,page_size:5}}},methods:{fetchData:function(e){var r=this;this.loading=!0,Object(o.x)(this.searchForm).then(function(e){r.workOrderTaskList=e.results,r.taskTotalNum=e.count,r.loading=!1}),Object(o.v)(e).then(function(e){r.workOrderTaskCode=e.code}),Object(o.t)(e).then(function(e){r.workOrderOperationCode=e.code}),Object(o.n)(e).then(function(e){r.workOrderModelList=e.results}),Object(n.h)().then(function(e){r.productList=e}),Object(a.d)().then(function(e){r.projectList=e.results})},fetchToDoData:function(e){var r=this;this.toDoListLoading=!0,void 0===e?Object(o.j)({page:1,page_size:5}).then(function(e){r.execWorkOrderTaskList=e.results,r.taskToDoTotalNum=e.count,r.toDoListLoading=!1}):Object(o.j)(e).then(function(e){r.execWorkOrderTaskList=e.results,r.taskToDoTotalNum=e.count,r.toDoListLoading=!1})},fetchAuditData:function(e){var r=this;this.auditListLoading=!0,void 0===e?Object(o.i)({page:1,page_size:5}).then(function(e){r.auditWorkOrderTaskList=e.results,r.auditTaskTotalNum=e.count,r.auditListLoading=!1}):Object(o.i)(e).then(function(e){r.auditWorkOrderTaskList=e.results,r.auditTaskTotalNum=e.count,r.auditListLoading=!1})},handleSearchTask:function(e){this.searchForm=e,this.fetchData()},handleCommitAddWorkOrderTask:function(e){var r=this;Object(o.g)(e).then(function(){r.$message({message:"操作成功",type:"success"}),r.fetchData()})},refresh:function(){this.fetchData()},refreshToDoList:function(e){this.fetchToDoData(e)},auditListRefresh:function(e){this.fetchAuditData(e)}},created:function(){this.fetchData(),this.fetchToDoData(),this.fetchAuditData()}},T={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"app-container"},[t("el-tabs",{attrs:{type:"border-card"}},[t("el-tab-pane",{attrs:{label:"我的工单"}},[t("my-work-order-list",{attrs:{workOrderTaskList:e.workOrderTaskList,workOrderModelList:e.workOrderModelList,taskTotalNum:e.taskTotalNum,productList:e.productList,projectList:e.projectList,loading:e.loading},on:{handleSearchTask:e.handleSearchTask,refresh:e.refresh,handleCommitAddWorkOrderTask:e.handleCommitAddWorkOrderTask}})],1)],1),e._v(" "),t("el-tabs",{attrs:{type:"border-card"}},[t("el-tab-pane",{attrs:{label:"待审核工单"}},[t("to-audit-work-order-list",{attrs:{auditWorkOrderTaskList:e.auditWorkOrderTaskList,auditListLoading:e.auditListLoading,auditTaskTotalNum:e.auditTaskTotalNum},on:{auditListRefresh:e.auditListRefresh}})],1)],1),e._v(" "),t("el-tabs",{attrs:{type:"border-card"}},[t("el-tab-pane",{attrs:{label:"待执行工单"}},[t("to-do-work-order-list",{attrs:{execWorkOrderTaskList:e.execWorkOrderTaskList,taskToDoTotalNum:e.taskToDoTotalNum,toDoListLoading:e.toDoListLoading},on:{refreshToDoList:e.refreshToDoList}})],1)],1)],1)},staticRenderFns:[]};var y=t("/Xao")(g,T,!1,function(e){t("1/UJ")},"data-v-47b2a0a5",null);r.default=y.exports},p7OI:function(e,r,t){(e.exports=t("UTlt")(!1)).push([e.i,"\n.el-row[data-v-5394d128] {\n  margin-bottom: 10px;\n}\n",""])},"qJ7+":function(e,r,t){var o=t("AvdV");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t("8bSs")("145f7cbb",o,!0)},zbLI:function(e,r,t){(e.exports=t("UTlt")(!1)).push([e.i,"\n.el-row[data-v-ab87d8b6] {\n  margin-bottom: 10px;\n}\n",""])}});